# Day2：障害物とGameOverの日（7人×3時間用シナリオ）

## 0. 今日のゴール（先生が最初に読む用）

3時間で、次を「クラス全体」として完成させます。

1. コース上に **障害物が流れてくる**  
2. 主人公と障害物が当たると **Game Over** になる  
3. 避け続けると **スコアが増えていく**（距離のイメージ）

### 絶対ルール

- `main_day1.py` は **書き換え禁止**（読むのはOK）
- 触るファイルは基本的に `main_day2.py` と `docs/Day2_buglog.md`
- 迷ったら先生かこのプリントに必ず戻る

---

## 1. 今日の7人の役割（先に割り当てる）

| No | 役割名                   | 触るファイル          | ざっくりやること                                      |
|----|--------------------------|-----------------------|-------------------------------------------------------|
| A  | 障害物生成タイミング担当 | `main_day2.py`        | いつ・どの間隔で障害物を出すかを決める                |
| B  | 障害物の見た目担当       | `main_day2.py`        | 障害物の大きさや高さを調整し、理不尽にならないようにする |
| C  | 当たり判定担当           | `main_day2.py`        | プレイヤーとのAABB当たり判定を書く                    |
| D  | GameOver処理担当         | `main_day2.py`        | 当たったときにゲームを止めて、メッセージを出す        |
| E  | スコア担当               | `main_day2.py`        | スコアの増え方と表示の仕組みを作る                    |
| F  | 難易度バランス担当       | `main_day2.py`        | 速度や障害物間隔を調整して、ちょうどいい難しさにする  |
| G  | テスト＆バグログ担当     | `docs/Day2_buglog.md` | テストプレイとバグ／改善アイデアの記録                |

---

## 2. 今日の時間割（板書用）

- 0:00〜0:10　Day1の復習と、Day2のゴール共有
- 0:10〜0:20　役割分担とゲームのイメージ共有
- 0:20〜1:10　**個人作業タイム**（A〜Fの担当ごとにコーディング）
- 1:10〜1:40　コードの結合＆簡単なプレイテスト
- 1:40〜2:20　G主導のテストプレイ＆バグログ作成
- 2:20〜3:00　今日のまとめと、Day3への発展案の確認

---

## 3. 各役割の「やることチェックリスト」

### 3-1. A：障害物生成タイミング担当

**目的**：障害物が「たまに出てくる」ようにし、間隔があまりにも理不尽にならないようにする。

#### チェックリスト

- [ ] `self.obstacles` のようなリストで障害物を管理している
- [ ] 一定間隔（例：スクロール量や時間）ごとに `spawn_obstacle()` を呼んでいる
- [ ] 生成した障害物の `x` 座標が、画面右の外から流れてくるようになっている
- [ ] 障害物が画面の左端を通り過ぎたらリストから削除している

#### サンプルコード（イメージ）

```python
    def spawn_obstacle(self):
        import random
        gap = random.choice([260, 320, 380])
        last_x = max([o[0] for o in self.obstacles], default=self.width + 100)
        x = max(self.width + 60, last_x + gap)
        w = random.choice([26, 32, 40])
        h = random.choice([26, 32, 44])
        y = GROUND_Y
        self.obstacles.append([x, y, w, h])
```

> ✅ Aさんは「**敵の出現ペース係**」です。  
> プレイしてみて「出なさすぎ／出すぎ」を感じたら、すぐにGさんに相談しましょう。

---

### 3-2. B：障害物の見た目担当

**目的**：障害物の大きさや高さを調整して、理不尽にならないようにする。

#### チェックリスト

- [ ] 小さい障害物・大きい障害物など、いくつかのパターンを用意した
- [ ] プレイヤーのジャンプ力でちゃんと越えられる高さに調整した
- [ ] 絶対によけられない配置（ジャンプしても当たる）が出ないか、テストした

> ✅ Bさんは「**コースデザイナー**」です。  
> あと一歩でよけられる…くらいの難易度を目指しましょう。

---

### 3-3. C：当たり判定担当

**目的**：プレイヤーと障害物が重なったときに「当たった」と判断する処理を書く。

#### チェックリスト

- [ ] AABB（Axis-Aligned Bounding Box）方式で当たり判定をしている
- [ ] プレイヤーと障害物の `x, y, w, h` を使っている
- [ ] 一度当たったら `self.gameover = True` をセットしている

#### サンプルコード（イメージ）

```python
    @staticmethod
    def aabb(ax, ay, aw, ah, bx, by, bw, bh):
        return not (ax + aw < bx or bx + bw < ax or
                    ay + ah < by or by + bh < ay)
```

`update` 内の当たり判定：

```python
        for (ox, oy, ow, oh) in self.obstacles:
            if self.aabb(self.x, self.y, self.w, self.h, ox, oy, ow, oh):
                self.gameover = True
```

> ✅ Cさんは「**判定の審判役**」です。  
> 「当たっていないのに当たり判定される」「その逆」がないか、Gさんと一緒に確認しましょう。

---

### 3-4. D：GameOver処理担当

**目的**：当たったらゲームを止めて、「Game Over」であることをプレイヤーに伝える。

#### チェックリスト

- [ ] `self.gameover` フラグを使って、Game Over 後はスクロールや入力を止めている
- [ ] HUDやラベルに「Game Over」と表示している
- [ ] （発展）`Rキーでリスタート` の下準備として、どこをリセットすべきか考えている

> ✅ Dさんは「**試合終了のアナウンサー**」です。  
> 「何が原因で死んだのか」が分かるように、メッセージを工夫してもよいです。

---

### 3-5. E：スコア担当

**目的**：生き延びている時間や距離に応じてスコアが増える仕組みを作る。

#### チェックリスト

- [ ] `self.score` を初期化している
- [ ] ゲームオーバーでない間、毎フレーム少しずつスコアを増やしている（距離や時間ベース）
- [ ] HUDのテキストにスコアを表示している
- [ ] スコアが増えすぎて桁が大きくなりすぎないように調整している

> ✅ Eさんは「**頑張りを数字にする係**」です。  
> スコアの伸びが「気持ちいい」かどうか、実際にプレイしながら調整してみてください。

---

### 3-6. F：難易度バランス担当

**目的**：ゲームの速度や障害物の間隔を調整して、「簡単すぎず・難しすぎず」にする。

#### チェックリスト

- [ ] `SPEED` や `_speed()` の値を確認した
- [ ] 障害物間隔（Aさんの `gap` 値）と合わせて難易度を調整した
- [ ] チームメンバー全員に1回ずつプレイしてもらい、感想を集めた

> ✅ Fさんは「**ゲームバランス調整役**」です。  
> 最後は「クラスの平均レベル」を見ながら、先生と一緒に決めてください。

---

### 3-7. G：テスト＆バグログ担当

**目的**：Day2 のゲームをいろいろなパターンで遊び、バグと改善点を文章に残す。

- 触るファイル：`docs/Day2_buglog.md`（新規作成）

#### チェックリスト

- [ ] 少なくとも5回以上プレイした
- [ ] 「すぐ死ぬ」「全然死なない」などの感想を具体的に書いた
- [ ] バグや改善案を1件ずつタイトル付きで記録した

---

## 4. 全員共通のNGリスト

- `main_day1.py` にDay2のコードを混ぜない（ファイルを分けておく）
- Game Over後も動き続けるバグを放置しない
- `print` デバッグを残しっぱなしにして、画面が見づらくなる状態で提出しない

---

## 5. 今日のまとめメモ欄（クラス用）

- 今日できたこと：

- 次にやりたいこと（Day3 への発展案など）：
